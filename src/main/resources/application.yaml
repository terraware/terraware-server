terraware:
  keycloak:
    api-client-id: "api"

keycloak:
  realm: "terraware"
  resource: "terraware-server"
#  token-cookie-path: "/"

spring:
  datasource:
    url: "${DATABASE_URL:jdbc:postgresql://localhost:5432/terraware}"
    username: "${DATABASE_USER:${USER:postgres}}"
    password: "${DATABASE_PASSWORD:}"

  flyway:
    locations:
      - "classpath:db/migration/postgres"
      - "classpath:db/migration/common"
    placeholders:
      jsonColumnType: "JSONB"

  mail:
    # Spring Boot Mail checks for the existence of this option; we want to enable it even if
    # we aren't using SMTP.
    host: dummy
    # Default to using authentication and TLS. Can opt out in local configuration.
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true

  servlet:
    multipart:
      max-request-size: 20MB
      max-file-size: 20MB

  session:
    store-type: jdbc

# Configuration for the Swagger API explorer. These settings are used when the server is running
# and serving real requests; there are also settings in application-apidoc.yaml that are used when
# generating the API documentation from the command line.
springdoc:
  # Limit the package scan to just the API classes. Otherwise the schema will include a bunch of
  # internal data model classes we don't actually expose to clients.
  packages-to-scan:
    - "com.terraformation.backend.customer.api"
    - "com.terraformation.backend.device.api"
    - "com.terraformation.backend.gis.api"
    - "com.terraformation.backend.search.api"
    - "com.terraformation.backend.seedbank.api"
    - "com.terraformation.backend.species.api"
    - "com.terraformation.backend.time.api"
  default-produces-media-type: "application/json"
  swagger-ui:
    # Disable the demo API (pet store)
    disable-swagger-default-url: true
    operations-sorter: alpha

logging:
  level:
    # Suppress a warning message about deserialization (Keycloak tries to add a serialization filter
    # in the middle of an object graph). See https://issues.redhat.com/browse/KEYCLOAK-15901
    org.keycloak.common.util.DelegatingSerializationFilter: ERROR
