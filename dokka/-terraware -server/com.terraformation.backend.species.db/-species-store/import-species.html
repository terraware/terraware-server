<!DOCTYPE html>
<html class="no-js">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>importSpecies</title>
    <link href="../../../images/logo-icon.svg" rel="icon" type="image/svg">
    <script>var pathToRoot = "../../../";</script>
    <script>document.documentElement.classList.replace("no-js","js");</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
    if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    } else {
        const savedDarkMode = JSON.parse(storage)
        if(savedDarkMode === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    }
    </script>
<script type="text/javascript" src="https://unpkg.com/kotlin-playground@1/dist/playground.min.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/sourceset_dependencies.js" async="async"></script>
<link href="../../../styles/style.css" rel="Stylesheet">
<link href="../../../styles/main.css" rel="Stylesheet">
<link href="../../../styles/prism.css" rel="Stylesheet">
<link href="../../../styles/logo-styles.css" rel="Stylesheet">
<link href="../../../styles/font-jb-sans-auto.css" rel="Stylesheet">
<script type="text/javascript" src="../../../scripts/clipboard.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/navigation-loader.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/platform-content-handler.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/main.js" defer="defer"></script>
<script type="text/javascript" src="../../../scripts/prism.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/symbol-parameters-wrapper_deferred.js" defer="defer"></script>
<script type="text/javascript" src="../../../dokka-mermaid.js" async="async"></script>
</head>
<body>
    <div class="root">
<nav class="navigation" id="navigation-wrapper">
    <div class="navigation--inner">
        <div class="navigation-title">
            <button class="menu-toggle" id="menu-toggle" type="button">toggle menu</button>
            <div class="library-name">
                    <a class="library-name--link" href="../../../index.html">
                            Terraware Server
                    </a>
            </div>
            <div class="library-version">
0.1-d62b389-SNAPSHOT            </div>
        </div>
        <div class="filter-section" id="filter-section">
                <button class="platform-tag platform-selector jvm-like" data-active="" data-filter=":dokkaHtml/main">jvm</button>
        </div>
    </div>
    <div class="navigation-controls">
        <button class="navigation-controls--btn navigation-controls--theme" id="theme-toggle-button" type="button">switch theme</button>
        <div class="navigation-controls--btn navigation-controls--search" id="searchBar" role="button">search in API</div>
    </div>
</nav>
        <div id="container">
            <div class="sidebar" id="leftColumn">
                <div class="sidebar--inner" id="sideMenu"></div>
            </div>
            <div id="main">
<div class="main-content" data-page-type="member" id="content" pageIds="Terraware Server::com.terraformation.backend.species.db/SpeciesStore/importSpecies/#com.terraformation.backend.species.model.SpeciesModel[kotlin.Nothing?]#kotlin.Boolean/PointingToDeclaration//769193423">
  <div class="breadcrumbs"><a href="../../../index.html">Terraware Server</a><span class="delimiter">/</span><a href="../index.html">com.terraformation.backend.species.db</a><span class="delimiter">/</span><a href="index.html">SpeciesStore</a><span class="delimiter">/</span><span class="current">importSpecies</span></div>
  <div class="cover ">
    <h1 class="cover"><span>import</span><wbr></wbr><span><span>Species</span></span></h1>
  </div>
  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":dokkaHtml/main"><div class="symbol monospace"><span class="token keyword"></span><span class="token keyword">fun </span><a href="import-species.html"><span class="token function">importSpecies</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">model<span class="token operator">: </span><a href="../../com.terraformation.backend.species.model/-new-species-model/index.html">NewSpeciesModel</a><span class="token punctuation">, </span></span><span class="parameter ">overwriteExisting<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html">Boolean</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="../../com.terraformation.backend.db.default_schema/-species-id/index.html">SpeciesId</a><span class="clearfix"><span class="floating-right">(<a href="https://github.com/terraware/terraware-server/tree/main/src/main/kotlin/com/terraformation/backend/species/db/SpeciesStore.kt#L300">source</a>)</span></span></div><p class="paragraph">Inserts or updates a single species, typically based on a row from an external data file, and pay attention to existing species that have been renamed.</p><p class="paragraph">Species are matched based on their scientific names, but this is a little tricky because we track renamed species and want to match on the original name. The use case is someone uploading a CSV, accepting a suggested name change, then uploading the CSV again; we want to remember that species X in the CSV is really species Y in our database because the user renamed it.</p><p class="paragraph">In addition, this needs to behave differently if there is an existing species but it is marked as deleted; sometimes we want to undelete the existing row and sometimes we want to ignore it. And it also needs to act differently depending on whether the user wants to overwrite existing data or only import new entries.</p><p class="paragraph">Exhaustive list of the possible cases:</p><ul><li><p class="paragraph">Current = the scientific name from the CSV is the same as the scientific name of an existing species (regardless of whether the existing species is deleted or not)</p></li><li><p class="paragraph">Initial = the scientific name from the CSV is the same as the initial scientific name of an existing species (regardless of whether the existing species is deleted or not)</p></li><li><p class="paragraph">Deleted = the existing species, if any, is marked as deleted</p></li><li><p class="paragraph">Overwrite = the <a href="import-species.html">overwriteExisting</a> parameter is true, meaning the user wants to update existing species rather than ignore them</p></li></ul><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">| Current | Initial | Deleted | Overwrite | Action |<br>| ------- | ------- | ------- | --------- | ------ |<br>| No      | No      | No      | No        | Insert |<br>| No      | No      | No      | Yes       | Insert |<br>| No      | No      | Yes     | No        | (impossible) |<br>| No      | No      | Yes     | Yes       | (impossible) |<br>| No      | Yes     | No      | No        | No-op |<br>| No      | Yes     | No      | Yes       | Update but use current name instead of CSV's |<br>| No      | Yes     | Yes     | No        | Insert |<br>| No      | Yes     | Yes     | Yes       | Insert |<br>| Yes     | No      | No      | No        | No-op |<br>| Yes     | No      | No      | Yes       | Update |<br>| Yes     | No      | Yes     | No        | Update and undelete |<br>| Yes     | No      | Yes     | Yes       | Update and undelete |<br>| Yes     | Yes     | No      | No        | No-op |<br>| Yes     | Yes     | No      | Yes       | Update species with same current name |<br>| Yes     | Yes     | Yes     | No        | Update species with same current name; undelete |<br>| Yes     | Yes     | Yes     | Yes       | Update species with same current name; undelete |</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><span class="kdoc-tag"><h4 class="">Return</h4><p class="paragraph">The ID of the existing species that matched the requested name or the new species that was inserted.</p></span></div></div>
</div>
      <div class="footer">
        <span class="go-to-top-icon"><a href="#content" id="go-to-top-link"></a></span><span>Â© 2023 Copyright</span><span
                class="pull-right"><span>Generated by </span><a
                href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span>
      </div>
            </div>
        </div>
    </div>
</body>
</html>
