<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<database name="terraware" schema="tracking" type="PostgreSQL - 13.1 (Debian 13.1-1.pgdg100+1)">
   <tables>
      <table name="deliveries" numRows="0" remarks="Incoming deliveries of new seedlings to a planting site. Mostly exists to link plantings and nursery withdrawals." schema="tracking" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="id" nullable="false" remarks="" size="19" type="int8" typeCode="-5">
            <child column="delivery_id" foreignKey="plantings_planting_site_id_delivery_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="plantings"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="withdrawal_id" nullable="false" remarks="Which nursery withdrawal the plants came from." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="deliveries_withdrawal_id_fkey" implied="false" onDeleteCascade="true" schema="nursery" table="withdrawals"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="2" name="planting_site_id" nullable="false" remarks="Which planting site received the delivery." size="19" type="int8" typeCode="-5">
            <child column="planting_site_id" foreignKey="plantings_planting_site_id_delivery_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="plantings"/>
            <parent column="id" foreignKey="deliveries_planting_site_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_sites"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="3" name="created_by" nullable="false" remarks="Which user created the delivery." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="deliveries_created_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="4" name="created_time" nullable="false" remarks="When the delivery was created." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="5" name="modified_by" nullable="false" remarks="Which user most recently modified the delivery." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="deliveries_modified_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="6" name="modified_time" nullable="false" remarks="When the delivery was most recently modified." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="7" name="reassigned_by" nullable="true" remarks="Which user recorded the reassignment of plants in this delivery. Null if this delivery has no reassignment." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="deliveries_reassigned_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="8" name="reassigned_time" nullable="true" remarks="When the reassignment was recorded. Null if this delivery has no reassignment." size="35" type="timestamptz" typeCode="93"/>
         <primaryKey column="id" sequenceNumberInPK="1"/>
         <index name="deliveries_pkey" unique="true">
            <column ascending="true" name="id"/>
         </index>
         <index name="deliveries_planting_site_id_id_key" unique="true">
            <column ascending="true" name="planting_site_id"/>
            <column ascending="true" name="id"/>
         </index>
         <index name="deliveries_withdrawal_id_key" unique="true">
            <column ascending="true" name="withdrawal_id"/>
         </index>
      </table>
      <table name="monitoring_plots" numRows="0" remarks="Regions within planting subzones that can be comprehensively surveyed in order to extrapolate results for the entire zone. Any monitoring plot in a subzone is expected to have roughly the same number of plants of the same species as any other monitoring plot in the same subzone." schema="tracking" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="id" nullable="false" remarks="" size="19" type="int8" typeCode="-5"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="planting_subzone_id" nullable="false" remarks="Which planting subzone this monitoring plot is part of." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="monitoring_plots_planting_subzone_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_subzones"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="2" name="name" nullable="false" remarks="" size="2147483647" type="text" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="3" name="full_name" nullable="false" remarks="" size="2147483647" type="text" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="4" name="created_by" nullable="false" remarks="Which user created the monitoring plot." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="monitoring_plots_created_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="5" name="created_time" nullable="false" remarks="When the monitoring plot was originally created." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="6" name="modified_by" nullable="false" remarks="Which user most recently modified the monitoring plot." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="monitoring_plots_modified_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="7" name="modified_time" nullable="false" remarks="When the monitoring plot was most recently modified." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="8" name="boundary" nullable="false" remarks="Boundary of the monitoring plot. Coordinates always use SRID 4326 (WGS 84 latitude/longitude)." size="2147483647" type="geometry" typeCode="1111"/>
         <primaryKey column="id" sequenceNumberInPK="1"/>
         <index name="monitoring_plots_pkey" unique="true">
            <column ascending="true" name="id"/>
         </index>
         <index name="monitoring_plots_planting_subzone_id_name_key" unique="true">
            <column ascending="true" name="planting_subzone_id"/>
            <column ascending="true" name="name"/>
         </index>
      </table>
      <table name="planting_sites" numRows="0" remarks="Top-level information about entire planting sites. Every planting site has at least one planting zone." schema="tracking" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="id" nullable="false" remarks="" size="19" type="int8" typeCode="-5">
            <child column="planting_site_id" foreignKey="deliveries_planting_site_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="deliveries"/>
            <child column="planting_site_id" foreignKey="plots_planting_site_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_subzones"/>
            <child column="planting_site_id" foreignKey="planting_zones_planting_site_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_zones"/>
            <child column="planting_site_id" foreignKey="plantings_planting_site_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="plantings"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="organization_id" nullable="false" remarks="Which organization owns this planting site." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="planting_sites_organization_id_fkey" implied="false" onDeleteCascade="true" schema="public" table="organizations"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="2" name="name" nullable="false" remarks="Short name of this planting site. Must be unique within the organization." size="2147483647" type="text" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="3" name="description" nullable="true" remarks="Optional user-supplied description of the planting site." size="2147483647" type="text" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="4" name="boundary" nullable="true" remarks="Boundary of the entire planting site. Planting zones will generally fall inside this boundary. This will typically be a single polygon but may be multiple polygons if a planting site has several disjoint areas. Coordinates always use SRID 4326 (WGS 84 latitude/longitude)." size="2147483647" type="geometry" typeCode="1111"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="5" name="created_by" nullable="false" remarks="Which user created the planting site." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="planting_sites_created_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="6" name="created_time" nullable="false" remarks="When the planting site was originally created." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="7" name="modified_by" nullable="false" remarks="Which user most recently modified the planting site." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="planting_sites_modified_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="8" name="modified_time" nullable="false" remarks="When the planting site was most recently modified." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="9" name="time_zone" nullable="true" remarks="" size="2147483647" type="text" typeCode="12">
            <parent column="time_zone" foreignKey="planting_sites_time_zone_fkey" implied="false" onDeleteCascade="false" schema="public" table="time_zones"/>
         </column>
         <primaryKey column="id" sequenceNumberInPK="1"/>
         <index name="planting_sites_pkey" unique="true">
            <column ascending="true" name="id"/>
         </index>
         <index name="planting_sites_organization_id_name_key" unique="true">
            <column ascending="true" name="organization_id"/>
            <column ascending="true" name="name"/>
         </index>
         <checkConstraint constraint="((description !~ similar_to_escape(' *'::text)))" name="planting_sites_description_check"/>
      </table>
      <table name="planting_subzones" numRows="0" remarks="Regions within planting zones that are a convenient size for a planting operation. Typically &lt;10Ha." schema="tracking" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="id" nullable="false" remarks="" size="19" type="int8" typeCode="-5">
            <child column="planting_subzone_id" foreignKey="monitoring_plots_planting_subzone_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="monitoring_plots"/>
            <child column="planting_subzone_id" foreignKey="plantings_planting_subzone_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="plantings"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="planting_zone_id" nullable="false" remarks="Which planting zone this subzone is part of." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="plots_planting_zone_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_zones"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="2" name="name" nullable="false" remarks="Short name of this planting subzone. This is often just a single letter and number. Must be unique within a planting zone." size="2147483647" type="text" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="3" name="full_name" nullable="false" remarks="" size="2147483647" type="text" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="4" name="boundary" nullable="true" remarks="Boundary of the subzone. Coordinates always use SRID 4326 (WGS 84 latitude/longitude)." size="2147483647" type="geometry" typeCode="1111"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="5" name="created_by" nullable="false" remarks="Which user created the subzone." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="plots_created_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="6" name="created_time" nullable="false" remarks="When the subzone was originally created." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="7" name="modified_by" nullable="false" remarks="Which user most recently modified the subzone." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="plots_modified_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="8" name="modified_time" nullable="false" remarks="When the subzone was most recently modified." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="9" name="planting_site_id" nullable="false" remarks="Which planting site this subzone is part of. This is the same as the planting site ID of this subzone's planting zone, but is duplicated here so it can be used as the target of a foreign key constraint." size="19" type="int8" typeCode="-5">
            <child column="planting_site_id" foreignKey="plantings_planting_site_id_plot_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="plantings"/>
            <parent column="planting_site_id" foreignKey="plots_planting_site_id_planting_zone_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="planting_zones"/>
            <parent column="id" foreignKey="plots_planting_site_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_sites"/>
         </column>
         <primaryKey column="id" sequenceNumberInPK="1"/>
         <index name="plots_pkey" unique="true">
            <column ascending="true" name="id"/>
         </index>
         <index name="plots_planting_site_id_id_key" unique="true">
            <column ascending="true" name="planting_site_id"/>
            <column ascending="true" name="id"/>
         </index>
         <index name="plots_planting_zone_id_name_key" unique="true">
            <column ascending="true" name="planting_zone_id"/>
            <column ascending="true" name="name"/>
         </index>
      </table>
      <table name="planting_types" numRows="3" remarks="(Enum) Type of planting associated with a delivery. Different planting types distinguish reassignments from initial plantings." schema="tracking" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="id" nullable="false" remarks="" size="10" type="int4" typeCode="4">
            <child column="planting_type_id" foreignKey="plantings_planting_type_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="plantings"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="name" nullable="false" remarks="" size="2147483647" type="text" typeCode="12"/>
         <primaryKey column="id" sequenceNumberInPK="1"/>
         <index name="planting_types_pkey" unique="true">
            <column ascending="true" name="id"/>
         </index>
      </table>
      <table name="planting_zones" numRows="0" remarks="Regions within planting sites that have a consistent set of conditions such that survey results from any part of the zone can be extrapolated to the entire zone. Planting zones are subdivided into plots. Every planting zone has at least one plot." schema="tracking" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="id" nullable="false" remarks="" size="19" type="int8" typeCode="-5">
            <child column="planting_zone_id" foreignKey="plots_planting_zone_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_subzones"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="planting_site_id" nullable="false" remarks="Which planting site this zone is part of." size="19" type="int8" typeCode="-5">
            <child column="planting_site_id" foreignKey="plots_planting_site_id_planting_zone_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="planting_subzones"/>
            <parent column="id" foreignKey="planting_zones_planting_site_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_sites"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="2" name="name" nullable="false" remarks="Short name of this planting zone. This is often just a single letter. Must be unique within a planting site." size="2147483647" type="text" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="3" name="boundary" nullable="true" remarks="Boundary of the planting zone. This area is further subdivided into plots. This will typically be a single polygon but may be multiple polygons if a planting zone has several disjoint areas. Coordinates always use SRID 4326 (WGS 84 latitude/longitude)." size="2147483647" type="geometry" typeCode="1111"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="4" name="created_by" nullable="false" remarks="Which user created the planting zone." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="planting_zones_created_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="5" name="created_time" nullable="false" remarks="When the planting zone was originally created." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="6" name="modified_by" nullable="false" remarks="Which user most recently modified the planting zone." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="planting_zones_modified_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="7" name="modified_time" nullable="false" remarks="When the planting zone was most recently modified." size="35" type="timestamptz" typeCode="93"/>
         <primaryKey column="id" sequenceNumberInPK="1"/>
         <index name="planting_zones_pkey" unique="true">
            <column ascending="true" name="id"/>
         </index>
         <index name="planting_zones_planting_site_id_id_key" unique="true">
            <column ascending="true" name="planting_site_id"/>
            <column ascending="true" name="id"/>
         </index>
         <index name="planting_zones_planting_site_id_name_key" unique="true">
            <column ascending="true" name="planting_site_id"/>
            <column ascending="true" name="name"/>
         </index>
      </table>
      <table name="plantings" numRows="0" remarks="Details about plants that were planted or reassigned as part of a delivery. There is one plantings row per species in a delivery." schema="tracking" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="id" nullable="false" remarks="" size="19" type="int8" typeCode="-5"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="delivery_id" nullable="false" remarks="Which delivery this planting is part of." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="plantings_planting_site_id_delivery_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="deliveries"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="2" name="planting_type_id" nullable="false" remarks="Whether this is the plant assignment from the initial delivery or an adjustment from a reassignment." size="10" type="int4" typeCode="4">
            <parent column="id" foreignKey="plantings_planting_type_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="planting_types"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="3" name="planting_site_id" nullable="false" remarks="Which planting site has the planting. Must be the same as the planting site ID of the delivery. This identifies the site as a whole; in addition, there may be a plot ID." size="19" type="int8" typeCode="-5">
            <parent column="planting_site_id" foreignKey="plantings_planting_site_id_delivery_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="deliveries"/>
            <parent column="id" foreignKey="plantings_planting_site_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_sites"/>
            <parent column="planting_site_id" foreignKey="plantings_planting_site_id_plot_id_fkey" implied="false" onDeleteCascade="false" schema="tracking" table="planting_subzones"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="4" name="planting_subzone_id" nullable="true" remarks="Which plot this planting affected, if any. Must be a plot at the planting site referenced by `planting_site_id`. Null if the planting site does not have plot information. For reassignments, this is the original plot if `num_plants` is negative, or the new plot if `num_plants` is positive." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="plantings_planting_subzone_id_fkey" implied="false" onDeleteCascade="true" schema="tracking" table="planting_subzones"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="5" name="species_id" nullable="false" remarks="Which species was planted." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="plantings_species_id_fkey" implied="false" onDeleteCascade="false" schema="public" table="species"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="6" name="created_by" nullable="false" remarks="Which user created the planting." size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="plantings_created_by_fkey" implied="false" onDeleteCascade="false" schema="public" table="users"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="7" name="created_time" nullable="false" remarks="When the planting was created. Note that plantings are never updated, so there is no modified time." size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="8" name="num_plants" nullable="false" remarks="Number of plants that were planted (if the number is positive) or reassigned (if the number is negative)." size="10" type="int4" typeCode="4"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="9" name="notes" nullable="true" remarks="Notes about this specific planting. In the initial version of the web app, the user can only enter per-planting notes for reassignments, not for initial deliveries." size="2147483647" type="text" typeCode="12"/>
         <primaryKey column="id" sequenceNumberInPK="1"/>
         <index name="plantings_pkey" unique="true">
            <column ascending="true" name="id"/>
         </index>
         <index name="plantings_delivery_id_idx" unique="false">
            <column ascending="true" name="delivery_id"/>
         </index>
         <index name="plantings_delivery_id_species_id_planting_type_id_key" unique="true">
            <column ascending="true" name="delivery_id"/>
            <column ascending="true" name="species_id"/>
            <column ascending="true" name="planting_type_id"/>
         </index>
         <index name="plantings_plot_id_idx" unique="false">
            <column ascending="true" name="planting_subzone_id"/>
         </index>
         <index name="plantings_species_id_idx" unique="false">
            <column ascending="true" name="species_id"/>
         </index>
         <checkConstraint constraint="((((planting_type_id = 2) AND (num_plants &lt; 0)) OR ((planting_type_id &lt;&gt; 2) AND (num_plants &gt; 0))))" name="num_plants_positive_unless_reassignment_from"/>
         <checkConstraint constraint="((notes !~ similar_to_escape(' *'::text)))" name="plantings_notes_check"/>
      </table>
   </tables>
</database>
